<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>GMT CONTROL | AUDITOR√çA</title>
    <script src="https://cdn.plot.ly/plotly-2.27.0.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        .day-box { width: 19px; height: 19px; border-radius: 4px; font-size: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; font-weight: bold; }
        .spr-high { background-color: #2563eb; color: white; }
        .vic-high { background-color: #f97316; color: white; }
        .day-off { background-color: #ffffff; color: #cbd5e1; border: 1px solid #e2e8f0; }
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
    </style>
</head>
<body class="bg-slate-50 p-4">
    <div id="dashboard_wrapper" class="max-w-7xl mx-auto">
        
        <div class="bg-white p-6 rounded-xl shadow-sm border mb-6 flex flex-col lg:flex-row justify-between items-center gap-4">
            <div>
                <h1 class="text-xl font-black uppercase text-slate-900">GMT CONTROL | <span class="text-blue-600">AUDITOR√çA</span></h1>
                <p class="text-[10px] font-bold text-slate-400 uppercase italic">Actualizado: <span id="last_update" class="text-blue-600 underline">--/--</span></p>
            </div>
            <div class="flex flex-wrap justify-center gap-3">
                <select id="filter_month" onchange="cargarArchivoMes(this.value)" class="bg-blue-50 text-blue-700 text-[10px] font-black px-4 py-2 rounded-lg border border-blue-100 outline-none">
                    <option value="01">ENERO 2026</option>
                    <option value="02" selected>FEBRERO 2026</option>
                </select>
                <select id="filter_ger" onchange="renderDashboard()" class="bg-slate-100 text-slate-700 text-[10px] font-black px-4 py-2 rounded-lg border border-slate-200 outline-none"></select>
                <button onclick="generarExcel()" class="bg-emerald-600 text-white px-5 py-2 rounded-lg text-[10px] font-black uppercase">üìä EXCEL</button>
            </div>
        </div>

        <div id="alerta_panel" class="bg-white border border-red-200 rounded-xl mb-6 overflow-hidden shadow-lg">
            <div class="bg-red-600 p-3 flex justify-between items-center text-white text-[10px] font-black">
                <span>‚ö†Ô∏è ALERTAS DE INACTIVIDAD / SIN ESTRUCTURA</span>
                <input type="text" id="search_user" oninput="renderDashboard()" placeholder="BUSCAR ASESOR..." class="bg-white/20 px-3 py-1 rounded outline-none placeholder-white/70 uppercase text-[9px] w-48">
            </div>
            <div class="max-h-64 overflow-y-auto">
                <table class="w-full text-[10px] text-left border-collapse">
                    <thead class="bg-slate-100 sticky top-0 uppercase font-bold text-slate-600">
                        <tr>
                            <th class="p-3 border-b">Ejecutivo</th>
                            <th class="p-3 border-b text-center">D√≠as Activos</th>
                            <th class="p-3 border-b">Horas Totales</th>
                            <th class="p-3 border-b">Gerencia / Campa√±a</th>
                        </tr>
                    </thead>
                    <tbody id="t_body_alerts" class="divide-y divide-slate-100 italic"></tbody>
                </table>
            </div>
        </div>

        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6">
            <div class="bg-white p-4 rounded-xl border shadow-sm text-center">
                <p class="text-[9px] font-bold text-slate-400">ALERTAS TOTALES</p>
                <p id="k_inact" class="text-2xl font-black text-red-600">0</p>
            </div>
            <div class="bg-white p-4 rounded-xl border shadow-sm text-center">
                <p class="text-[9px] font-bold text-slate-400">TOTAL CONEXI√ìN</p>
                <p id="k_tot" class="text-2xl font-black text-slate-800">00:00</p>
            </div>
        </div>

        <div class="bg-white rounded-xl shadow border overflow-x-auto">
            <table class="w-full text-[10px]">
                <tbody id="t_body_calendar" class="divide-y"></tbody>
            </table>
        </div>
    </div>
